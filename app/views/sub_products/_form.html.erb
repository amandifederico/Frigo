<div class="col-sm-8">
  <%= form_for(sub_product) do |f| %>
    <% if sub_product.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(sub_product.errors.count, "error") %> prohibited this sub_product from being saved:</h2>

        <ul>
        <% sub_product.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= f.collection_select :lot_id, Lot.all, :id, :to_s, {prompt: "Lote"}, {class: "select2"} %>
    </div>

    <div class="form-group">
      <%= f.text_field :observartion, class: "form-control input-lg", placeholder: "Observacion"%>
    </div>

    <table class="table table-striped table-bordered table-list">
      <thead>
        <tr>
          <th class="hidden-xs">Tipo</th>
          <th>Peso</th>
          <th>Peso control</th>
          <th>Observacion</th>
        </tr> 
      </thead>
      <tbody>
        <div class="form-group">
        <%= f.fields_for :sub_product_details do |sub_product_details| %>
          <%= render 'sub_product_detail_fields', :f => sub_product_details %>
        <% end %>
        <div class='links'>
          <%= link_to_add_association 'add sbd', f, :sub_product_details %>
        </div>
      </tbody>
    </table>
    <div class="actions">
      <%= f.submit class: "btn btn-success"%>
    </div>
  <% end %>
  <!--div class="add-button" style="margin:15px;">
      <button class="btn btn-success btn-sm" style="" onclick="add_subproduct_details()">
        <%= fa_icon "users", text:"Agregar Subproducto", right: true%>
      </button>
    </div-->
</div>


<script type="text/javascript">
  function add_subproduct_details(){
    console.log("Lo")
    $('#navbar-search').focus();
    $.ajax({
      url: '/sub_product/edit_with_details',
      type: 'POST',
    }).done(function(data) {
      $('tbody').append('<tr><td></td><td><%= number_field :weight, class: "form-control input-lg", placeholder: "Peso"%></td><td><%= number_field :weight_control, class: "form-control input-lg", placeholder: "Peso control"%></td><td><%= text_field :observation, class: "form-control input-lg", placeholder: "Observacion"%></td></tr>');
    }).fail(function(xhr, status, error) {
      
    });
  }
</script>