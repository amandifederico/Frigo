<%= form_for(product_detail) do |f| %>
    <% if product_detail.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(product_detail.errors.count, "error") %> prohibited this product_detail from being saved:</h2>

        <ul>
        <% product_detail.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>
    
    <div class="form-group">
      <% if @prod %>
        <%= f.collection_select :product_id, Product.where(id: @prod), :id, :to_s, {:selected => @prod},{class: "select2"}%>
      <% else %>
        <%= f.collection_select :product_id, Product.all(), :id, :to_s, {prompt: "Producto"}, {class: "select2"} %>
      <% end %>      
    </div>

    <div class="form-group">
      <%= f.collection_select :type_id, Type.all, :id, :to_s, {prompt: "Tipo"}, {class: "select2"} %>
    </div>

    <div class="form-group">
      <% if @prod %>
        <%= f.collection_select :animal_id, Animal.where(id: LotDetail.where(lot: Product.where(id: @prod).first.lot).pluck(:animal_id)), :id, :to_s, {prompt: "Especie"}, {class: "select2"} %>
      <% else %>
        <%= f.collection_select :animal_id, Animal.all, :id, :to_s, {prompt: "Especie"}, {class: "select2"} %>
      <% end %>
    </div>

    <div class="form-group">
      <%= f.number_field :weight, class: "form-control input-lg", placeholder: "Peso"%>
    </div>

    <div class="form-group">
      <%= f.number_field :weight_control, class: "form-control input-lg", placeholder: "Peso control"%>
    </div>

    <div class="form-group">
      <%= f.text_field :observation, class: "form-control input-lg", placeholder: "Observacion"%>
    </div>

    <% if @prod %>
      <%= f.hidden_field :flag, value: true %>
    <% end %>

    <div class="actions row">
        <div class="col-sm-4">
          <% if @prod %>
            <%= link_to 'Volver', "/production_line", class: "btn btn-outline-primary btn-block" %>
          <% else %>
            <%= link_to 'Volver', product_details_path, class: "btn btn-outline-primary btn-block" %>
          <% end %>          
        </div>      
        <div class="col-sm-8">
          <%= f.submit class: "btn btn-outline-success btn-block"%>
        </div>  
    </div>
<% end %>
